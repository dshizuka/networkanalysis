<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Dai Shizuka" />


<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Network Analysis Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="tutorials.html">Tutorials</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"><ol start="11" style="list-style-type: decimal">
<li>Intro to Diffusion on Networks</li>
</ol></h1>
<h4 class="author"><em>Dai Shizuka</em></h4>
<h4 class="date"><em>7/12/2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#diffusionflowtransmission-through-a-network">11.1 Diffusion/Flow/Transmission through a network</a><ul>
<li><a href="#simulation-of-asocial-changes-in-state-e.g.-asocial-learning">11.2 Simulation of asocial changes in state (e.g., asocial learning)</a></li>
<li><a href="#simulation-the-social-transmission-of-whatever-state-in-a-random-graph">11.3 Simulation the social transmission of <em>whatever</em> state in a random graph</a></li>
</ul></li>
</ul>
</div>

<p>Packages you will need for this tutorial:</p>
<pre class="r"><code>library(igraph)</code></pre>
<hr />
<div id="diffusionflowtransmission-through-a-network" class="section level1">
<h1>11.1 Diffusion/Flow/Transmission through a network</h1>
<p>One of the assumptions of network theory is that the connections between elements in a system matter to the function/property of the system and/or the individual elements within the system. One way in which such connections matters is that they can facilitate the flow of <em>something</em> through this system. Some examples include:</p>
<ul>
<li>Electricity through an electric grid</li>
<li>Bits of information through the internet</li>
<li>Vehicles/individuals moving through a transportation network</li>
<li>Information through social networks</li>
<li>Disease through contact networks</li>
<li>Modification of social strategies through competition networks</li>
</ul>
<p><br></p>
<p>One of the classical theories on social spread is that the accumulation of individuals (nodes) that take on a new state (e.g., an innovation) takes on different pattern when the spread is due to asocial processes (e.g., everyone innovates on their own) versus social processes (e.g., innovation spreads through social transmission).</p>
<div class="figure">
<img src="assets/images/FranzNunn2009.png" alt="Figure showing classical predictions of asocial versus social spread of innovations. From Franz &amp; Nunn (2009)." />
<p class="caption">Figure showing classical predictions of asocial versus social spread of innovations. From <a href="http://rspb.royalsocietypublishing.org/content/276/1663/1829">Franz &amp; Nunn (2009)</a>.</p>
</div>
<p>Here, let’s explore this paradigm by actually simulating the spread of innovation due to asocial or social processes.</p>
<div id="simulation-of-asocial-changes-in-state-e.g.-asocial-learning" class="section level2">
<h2>11.2 Simulation of asocial changes in state (e.g., asocial learning)</h2>
<p>Let’s first consider a situation where each individual in a social network has an inherent probability to adopt the innovation at any given time.</p>
<p>First, we will make a random graph consisting of 100 nodes. We will set the initial ‘innovation adoption’ status for all individuals (all initially 0).</p>
<pre class="r"><code>set.seed(4)
n=100
g=erdos.renyi.game(n, p=0.05)
V(g)$status=0 #the &#39;innovation adoption status&#39; for each individual. All initially 0.</code></pre>
<p>Let’s plot this random graph. While we’re at it, we will save the layout so that we can use it for all the plots of this network later.</p>
<pre class="r"><code>l=layout_with_fr(g)
plot(g, vertex.label=&quot;&quot;, vertex.size=8, vertex.color=&quot;darkgray&quot;, layout=l)</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<p>Now, we will set the ‘asocial learning’ parameter, <span class="math inline">\(x\)</span> to be 0.1. This is the probability that any given individual will come up with the innovation–e.g., how to forage for a new prey item.</p>
<pre class="r"><code>x=0.1</code></pre>
<p>Let’s run one practice run of how this will work. In one time step, we flip a coin for each individual whether or not they will adopt the innovation. Based on the coin flip, we will convert the status of the individual to 1 if they learned the innovation in that time step:</p>
<pre class="r"><code>adopt=sample(c(1,0),n, prob=c(x, 1-x), replace=T) #based on the probabilities, flip a coin and determine if the individual adopted or not.

V(g)$status[which(adopt==1)]=1 #change status of new adopters adopt.list[[j]]=which(adopters==1) #save the identities of adopters for that time step

plot(g, vertex.label=&quot;&quot;, vertex.color=c(&quot;darkgray&quot;, &quot;red&quot;)[V(g)$status+1], vertex.size=8, layout=l)</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-5-1.png" width="480" /></p>
<p>Now, we will repeat this simulation for 20 time steps. Here, we need to consider that any given individual can only adopt an innovation once (it can’t go back). If you’re thinking about this in terms of disease, it’s like an ‘SI model’ in which individuals do not recover or go back to a susceptible state. In practical terms, this means that we will just ignore coin flips for individuals whose status = 1.</p>
<pre class="r"><code>t=20
adopt.list=list(0) #empty list t=20
g.time=list()
for(j in 1:t){
  adopt=sample(c(1,0), n, prob=c(x, 1-x), replace=T) #coin flip
  V(g)$status[which(adopt==1)]=1
  g.time[[j]]=g
}</code></pre>
<pre class="r"><code>sapply(g.time, function(x) V(x)$status)</code></pre>
<pre><code>##        [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
##   [1,]    0    1    1    1    1    1    1    1    1     1     1     1
##   [2,]    0    0    0    0    0    1    1    1    1     1     1     1
##   [3,]    1    1    1    1    1    1    1    1    1     1     1     1
##   [4,]    0    0    0    0    0    0    0    0    0     0     0     0
##   [5,]    0    1    1    1    1    1    1    1    1     1     1     1
##   [6,]    0    1    1    1    1    1    1    1    1     1     1     1
##   [7,]    0    0    0    0    0    0    0    1    1     1     1     1
##   [8,]    0    0    0    0    0    1    1    1    1     1     1     1
##   [9,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [10,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [11,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [12,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [13,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [14,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [15,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [16,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [17,]    0    0    0    0    0    1    1    1    1     1     1     1
##  [18,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [19,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [20,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [21,]    0    0    0    0    0    0    0    0    1     1     1     1
##  [22,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [23,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [24,]    0    0    0    1    1    1    1    1    1     1     1     1
##  [25,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [26,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [27,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [28,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [29,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [30,]    0    0    0    0    0    0    0    0    0     0     0     1
##  [31,]    0    0    0    0    0    1    1    1    1     1     1     1
##  [32,]    0    0    0    0    0    1    1    1    1     1     1     1
##  [33,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [34,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [35,]    0    0    0    1    1    1    1    1    1     1     1     1
##  [36,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [37,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [38,]    0    0    1    1    1    1    1    1    1     1     1     1
##  [39,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [40,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [41,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [42,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [43,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [44,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [45,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [46,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [47,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [48,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [49,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [50,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [51,]    0    0    1    1    1    1    1    1    1     1     1     1
##  [52,]    0    0    0    0    0    0    0    0    0     1     1     1
##  [53,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [54,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [55,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [56,]    0    0    0    1    1    1    1    1    1     1     1     1
##  [57,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [58,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [59,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [60,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [61,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [62,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [63,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [64,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [65,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [66,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [67,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [68,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [69,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [70,]    0    0    0    0    0    0    0    0    0     0     0     1
##  [71,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [72,]    0    0    0    0    0    0    0    0    1     1     1     1
##  [73,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [74,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [75,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [76,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [77,]    0    0    0    0    1    1    1    1    1     1     1     1
##  [78,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [79,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [80,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [81,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [82,]    0    0    1    1    1    1    1    1    1     1     1     1
##  [83,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [84,]    0    1    1    1    1    1    1    1    1     1     1     1
##  [85,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [86,]    0    0    0    0    0    0    0    0    0     0     0     1
##  [87,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [88,]    0    0    0    1    1    1    1    1    1     1     1     1
##  [89,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [90,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [91,]    0    0    0    0    0    0    1    1    1     1     1     1
##  [92,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [93,]    0    0    0    1    1    1    1    1    1     1     1     1
##  [94,]    0    0    0    0    0    0    0    0    0     0     0     1
##  [95,]    0    0    0    0    0    0    0    0    0     0     1     1
##  [96,]    1    1    1    1    1    1    1    1    1     1     1     1
##  [97,]    0    0    1    1    1    1    1    1    1     1     1     1
##  [98,]    0    0    0    0    0    0    0    0    0     0     0     0
##  [99,]    1    1    1    1    1    1    1    1    1     1     1     1
## [100,]    0    0    1    1    1    1    1    1    1     1     1     1
##        [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20]
##   [1,]     1     1     1     1     1     1     1     1
##   [2,]     1     1     1     1     1     1     1     1
##   [3,]     1     1     1     1     1     1     1     1
##   [4,]     0     0     1     1     1     1     1     1
##   [5,]     1     1     1     1     1     1     1     1
##   [6,]     1     1     1     1     1     1     1     1
##   [7,]     1     1     1     1     1     1     1     1
##   [8,]     1     1     1     1     1     1     1     1
##   [9,]     0     0     0     0     1     1     1     1
##  [10,]     1     1     1     1     1     1     1     1
##  [11,]     0     0     0     0     0     0     0     0
##  [12,]     0     0     0     0     0     0     0     0
##  [13,]     1     1     1     1     1     1     1     1
##  [14,]     1     1     1     1     1     1     1     1
##  [15,]     1     1     1     1     1     1     1     1
##  [16,]     0     1     1     1     1     1     1     1
##  [17,]     1     1     1     1     1     1     1     1
##  [18,]     0     0     0     0     0     0     0     0
##  [19,]     1     1     1     1     1     1     1     1
##  [20,]     1     1     1     1     1     1     1     1
##  [21,]     1     1     1     1     1     1     1     1
##  [22,]     1     1     1     1     1     1     1     1
##  [23,]     1     1     1     1     1     1     1     1
##  [24,]     1     1     1     1     1     1     1     1
##  [25,]     1     1     1     1     1     1     1     1
##  [26,]     1     1     1     1     1     1     1     1
##  [27,]     1     1     1     1     1     1     1     1
##  [28,]     1     1     1     1     1     1     1     1
##  [29,]     1     1     1     1     1     1     1     1
##  [30,]     1     1     1     1     1     1     1     1
##  [31,]     1     1     1     1     1     1     1     1
##  [32,]     1     1     1     1     1     1     1     1
##  [33,]     1     1     1     1     1     1     1     1
##  [34,]     1     1     1     1     1     1     1     1
##  [35,]     1     1     1     1     1     1     1     1
##  [36,]     1     1     1     1     1     1     1     1
##  [37,]     1     1     1     1     1     1     1     1
##  [38,]     1     1     1     1     1     1     1     1
##  [39,]     1     1     1     1     1     1     1     1
##  [40,]     1     1     1     1     1     1     1     1
##  [41,]     1     1     1     1     1     1     1     1
##  [42,]     0     0     0     0     1     1     1     1
##  [43,]     0     0     0     0     1     1     1     1
##  [44,]     1     1     1     1     1     1     1     1
##  [45,]     0     0     0     0     0     0     0     0
##  [46,]     1     1     1     1     1     1     1     1
##  [47,]     0     0     1     1     1     1     1     1
##  [48,]     1     1     1     1     1     1     1     1
##  [49,]     1     1     1     1     1     1     1     1
##  [50,]     0     0     0     0     0     0     0     0
##  [51,]     1     1     1     1     1     1     1     1
##  [52,]     1     1     1     1     1     1     1     1
##  [53,]     1     1     1     1     1     1     1     1
##  [54,]     1     1     1     1     1     1     1     1
##  [55,]     0     0     0     0     0     0     0     0
##  [56,]     1     1     1     1     1     1     1     1
##  [57,]     1     1     1     1     1     1     1     1
##  [58,]     1     1     1     1     1     1     1     1
##  [59,]     0     1     1     1     1     1     1     1
##  [60,]     1     1     1     1     1     1     1     1
##  [61,]     1     1     1     1     1     1     1     1
##  [62,]     1     1     1     1     1     1     1     1
##  [63,]     0     0     1     1     1     1     1     1
##  [64,]     0     0     0     0     0     0     0     0
##  [65,]     1     1     1     1     1     1     1     1
##  [66,]     1     1     1     1     1     1     1     1
##  [67,]     1     1     1     1     1     1     1     1
##  [68,]     0     0     1     1     1     1     1     1
##  [69,]     1     1     1     1     1     1     1     1
##  [70,]     1     1     1     1     1     1     1     1
##  [71,]     1     1     1     1     1     1     1     1
##  [72,]     1     1     1     1     1     1     1     1
##  [73,]     1     1     1     1     1     1     1     1
##  [74,]     0     1     1     1     1     1     1     1
##  [75,]     0     0     0     0     0     0     0     0
##  [76,]     1     1     1     1     1     1     1     1
##  [77,]     1     1     1     1     1     1     1     1
##  [78,]     0     0     0     0     0     0     0     0
##  [79,]     1     1     1     1     1     1     1     1
##  [80,]     1     1     1     1     1     1     1     1
##  [81,]     1     1     1     1     1     1     1     1
##  [82,]     1     1     1     1     1     1     1     1
##  [83,]     1     1     1     1     1     1     1     1
##  [84,]     1     1     1     1     1     1     1     1
##  [85,]     1     1     1     1     1     1     1     1
##  [86,]     1     1     1     1     1     1     1     1
##  [87,]     0     0     0     0     0     0     1     1
##  [88,]     1     1     1     1     1     1     1     1
##  [89,]     1     1     1     1     1     1     1     1
##  [90,]     0     1     1     1     1     1     1     1
##  [91,]     1     1     1     1     1     1     1     1
##  [92,]     0     1     1     1     1     1     1     1
##  [93,]     1     1     1     1     1     1     1     1
##  [94,]     1     1     1     1     1     1     1     1
##  [95,]     1     1     1     1     1     1     1     1
##  [96,]     1     1     1     1     1     1     1     1
##  [97,]     1     1     1     1     1     1     1     1
##  [98,]     0     0     0     0     0     0     0     0
##  [99,]     1     1     1     1     1     1     1     1
## [100,]     1     1     1     1     1     1     1     1</code></pre>
<p>Ok, now let’s make a cumulative list of who</p>
<pre class="r"><code>adopt.cumulative=list()
for(i in 1:t){
  adopt.cumulative[[i]]=unlist(adopt.list[1:i])
}</code></pre>
<pre class="r"><code>layout(matrix(1:20, byrow=T, nrow=5))
par(mar=c(1,1,1,1))
for(i in 1:t){
  v.col=c(&quot;darkgray&quot;, &quot;red&quot;)[V(g.time[[i]])$status+1]
  plot(g.time[[i]], vertex.label=&quot;&quot;, vertex.color=c(&quot;darkgray&quot;, &quot;red&quot;)[v.col], layout=l, main=paste(&quot;Time&quot;,i))
}</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-9-1.png" width="480" /></p>
<pre class="r"><code>n.adopt.asocial=sapply(adopt.list, length) #for each time step, count the number of adopters.
cumulative.asocial=cumsum(n.adopt.asocial)
plot(cumulative.asocial, type=&quot;b&quot;, las=1, ylab=&quot;Cumulative number of nodes adopted&quot;, xlab=&quot;Time&quot;)</code></pre>
</div>
<div id="simulation-the-social-transmission-of-whatever-state-in-a-random-graph" class="section level2">
<h2>11.3 Simulation the social transmission of <em>whatever</em> state in a random graph</h2>
<p>First, we will create an Erdös-Renyí Random Graph with 100 nodes and p = 0.1</p>
<pre class="r"><code>library(igraph)
set.seed(4)
n=100
g=erdos.renyi.game(n, p=0.05) #create a Erdos-Renyi Random Graph with uniform edge probability = 0.1
plot(g, vertex.label=&quot;&quot;, vertex.size=8, vertex.color=&quot;darkgray&quot;, layout=l)</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-11-1.png" width="480" /></p>
<p>Next, we will create a vertex attribute called “state”. Everyone will start with state = 1. Then, we will randomly pick 2 nodes who will have state = 2</p>
<pre class="r"><code>V(g)$state=0 # Create a vertex attribute for adoption status. 1 if the node has adopted the innovation. 0 if not.
seed=sample(V(g),2) #select 2 innovators
V(g)$state[seed]=1 #These &#39;seed&#39; individuals get a status of 1 at the beginning.
plot(g, vertex.label=&quot;&quot;, vertex.size=8, vertex.color=c(&quot;darkgray&quot;, &quot;red&quot;)[V(g)$state+1], layout=l)</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-12-1.png" width="480" /></p>
<p>Now, we will set a “social transmission” parameter, <span class="math inline">\(s\)</span>. You can think of this as the linear increase in the probability that an individual will take on a new “state” (e.g., learn a new foraging strategy or get infected by a disease) when it has a ‘neighbor’ that has that state. Since it’s a probabilty 0 ≤ <span class="math inline">\(s\)</span> ≤ 1.</p>
<p>Let’s set s = 0.1 for now:</p>
<pre class="r"><code>s = 0.1</code></pre>
<p>Now we will simulate 20 time steps of the spread of this “state”.</p>
<pre class="r"><code>t=20 #time steps to run the simulation
adopt.list=list(0) #empty list 

for (j in 1:t){
nei.adopt=sapply(V(g), function(x) sum(V(g)$state[neighbors(g,x)]))
p=(1-exp(-s*nei.adopt))*abs(V(g)$state-1) #here, we multiply the probabilities by 0 if node is already adopted, and 1 if not yet adopted
adopters=sapply(p, function(x) sample(c(1,0), 1, prob=c(x, 1-x)))
V(g)$state[which(adopters==1)]=1
adopt.list[[j]]=which(adopters==1)
}</code></pre>
<pre class="r"><code>n.adopt.social=sapply(adopt.list, length) #for each time step, count the number of adopters.
cumulative.social=cumsum(n.adopt.social)
plot(cumulative.social, type=&quot;b&quot;, las=1, ylab=&quot;Cumulative number of nodes adopted&quot;, xlab=&quot;Time&quot;)</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-15-1.png" width="480" /></p>
<pre class="r"><code>adopt.list</code></pre>
<pre><code>## [[1]]
## integer(0)
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] 32
## 
## [[4]]
## [1] 25 87
## 
## [[5]]
## integer(0)
## 
## [[6]]
## [1] 43
## 
## [[7]]
## [1] 75 93 97
## 
## [[8]]
## [1]  2  9 23
## 
## [[9]]
## [1] 70
## 
## [[10]]
## [1] 62 69 88
## 
## [[11]]
## [1] 20 40 53
## 
## [[12]]
## [1] 30 38 74 82 84
## 
## [[13]]
## [1] 15 18 36 44 72 81 90 94
## 
## [[14]]
## [1] 12 13 14 22 42 57 58 65
## 
## [[15]]
## [1] 28 56 73
## 
## [[16]]
## [1]  19  33  68  76  80  96 100
## 
## [[17]]
## [1]  4 21 41 59 66
## 
## [[18]]
##  [1]  8 11 16 17 24 26 35 55 67 78
## 
## [[19]]
## [1]  3 10 27 60 85 99
## 
## [[20]]
## [1]  5 34 37 47 83</code></pre>
<pre class="r"><code>adopt.cumulative=list()
for(i in 1:t){
  adopt.cumulative[[i]]=unlist(adopt.list[1:i])
}</code></pre>
<pre class="r"><code>layout(matrix(1:20, byrow=T, nrow=5))
par(mar=c(1,1,1,1))
for(i in 1:t){
  v.col=1:n %in% adopt.cumulative[[i]]+1
  plot(g, vertex.label=&quot;&quot;, vertex.color=c(&quot;darkgray&quot;, &quot;red&quot;)[v.col], layout=l, main=paste(&quot;Time&quot;,i))
}</code></pre>
<p><img src="11_diffusion_files/figure-html/unnamed-chunk-17-1.png" width="576" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
