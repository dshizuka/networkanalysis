<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Dai Shizuka" />


<title>4.3 Intro to Spatial Networks</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Network Analysis Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="tutorials.html">Tutorials</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">4.3 Intro to Spatial Networks</h1>
<h4 class="author"><em>Dai Shizuka</em></h4>
<h4 class="date"><em>7/10/2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#spatial-network-of-lophocereus-schottii">4.3.1 Spatial network of <em>Lophocereus schottii</em></a></li>
<li><a href="#using-spatial-data-to-plot-networks">4.3.2 Using spatial data to plot networks</a></li>
</ul>
</div>

<p>Spatial networks</p>
<p>With spatial networks, the nodes represent spatial locations and the edges represent connections between those locations, e.g., <em>habitat connectivity</em> (‘landscape connectivity networks’: Urban &amp; Keitt 2001, Urban et al. 2009), <em>movements of individuals</em> (‘movement networks’: Jacoby &amp; Freeman 2016), <em>genetic covariance among populations</em> (‘population graphs’: Dyer &amp; Nason 2004, Dyer 2015), <em>migration pathways</em> (‘migratory flow networks’: Taylor &amp; Norris 2010). Such networks of connectivity between populations are important in a variety of fields including conservation biology, population genetics, evolution and metapopulation ecology.</p>
<div id="spatial-network-of-lophocereus-schottii" class="section level2">
<h2>4.3.1 Spatial network of <em>Lophocereus schottii</em></h2>
<div class="figure">
<img src="https://www.dropbox.com/s/bvclexwgv2zktur/L.schottii.jpg?dl=1" alt="Lophocereus schottii" />
<p class="caption"><em>Lophocereus schottii</em></p>
</div>
<p>To explore this type of data, we will be demonstrating the construction of space-based networks using a dataset on genetic connectivity (‘population graph’) of the cactus <em>Lophocereus schottii</em> from Dyer &amp; Nason (2004). We will be using an R package called ‘popgraph’, written by Rodney Dyer. A nice tutorial is available online (<a href="http://dyerlab.github.io/popgraph/" class="uri">http://dyerlab.github.io/popgraph/</a>), and the codes here are mostly adapted from this site.</p>
<p>First, we will import an adjacency matrix of genetic connectivity among sites in L. schottii (Dyer &amp; Nason 2004). Nason et al. (2002) assayed 29 polymorphic allozyme loci from 948 individual cacti in 21 populations. This data was converted to a 21 x 21 genetic distance matrix. Then the pairs of populations that were (using a method called edge exclusion deviance; see Dyer and Nason 2004 for details). In the resulting network (i.e., ‘population graph’), sites are connected by an edge if they are genetically ‘significantly similar’ (i.e., there is gene flow).</p>
<pre class="r"><code>library(igraph)
library(popgraph)
library(ggmap)</code></pre>
<p>Let’s read the data and take a look (output not shown here):</p>
<pre class="r"><code>lopnet=as.matrix(read.csv(&quot;https://dshizuka.github.io/networkanalysis/SampleData/lopho_network.csv&quot;, header=T, row.names=1)) #From Dyer et al. 2004
lopnet</code></pre>
<p>Now, let’s convert this into a graph object and plot it:</p>
<pre class="r"><code>g=graph_from_adjacency_matrix(lopnet, mode=&quot;undirected&quot;) 
plot(g)</code></pre>
<p><img src="04.3_spatialnets_files/figure-html/unnamed-chunk-3-1.png" width="576" /></p>
<p>Again, in this network, each node represents a population and the edges connect populations that are significantly similar genetically.</p>
</div>
<div id="using-spatial-data-to-plot-networks" class="section level2">
<h2>4.3.2 Using spatial data to plot networks</h2>
<p>Now, let’s now display this network using the actual locations of the nodes. To do this, we will read in a second dataset that includes the latitude/longitude coordinates of each node as well as a “region” variable indicating whether the population is in Sonora or Baja state of Mexico. This data is from Table 1 in Nason et al. (2002).</p>
<pre class="r"><code>locations=read.csv(&quot;https://dshizuka.github.io/networkanalysis/SampleData/lopho_locations.csv&quot;) 
head(locations)</code></pre>
<pre><code>##   Population Region     Lat      Long
## 1         CP Sonora 27.9461 -110.6594
## 2         TS Sonora 28.4050 -111.3658
## 3         SN Sonora 28.8211 -111.7992
## 4       Seri Sonora 28.8761 -111.9550
## 5         SG Sonora 29.3950 -112.0536
## 6         SI Sonora 29.7539 -112.5050</code></pre>
<p>We can use these coordinates to plot the spatial network. We won’t worry about specific projection methods for converting coordinates to 2D. We can do this by creating a 2-column matrix of x- and y-coordinates and using this as the ‘layout’, which we can specify when plotting the network. While we’re at it, we will also color-code the nodes based on region:</p>
<pre class="r"><code>#create a two-column matrix of x- and y-coordinates
V(g)$x=locations[match(V(g)$name, locations$Population),&quot;Long&quot;]
V(g)$y=locations[match(V(g)$name, locations$Population),&quot;Lat&quot;]
l=matrix(c(V(g)$x, V(g)$y), ncol=2)

# color-code nodes by region
regions=locations[match(V(g)$name, locations$Population),&quot;Region&quot;]
V(g)$color=c(&quot;tomato&quot;, &quot;turquoise2&quot;)[as.numeric(regions)]</code></pre>
<p>Now, let’s compare what the networks look like when using this ‘spatial layout’, compared to a force-directed layout (Fruchterman-Reingold), which is the default layout in igraph.</p>
<pre class="r"><code>par(mfrow=c(1,2), mar=c(2,2,2,2))
plot(g, layout=l, main=&quot;Spatial Layout&quot;)
plot(g, layout=layout_with_fr(g), main=&quot;Force-directed layout&quot;)</code></pre>
<p><img src="04.3_spatialnets_files/figure-html/unnamed-chunk-6-1.png" width="576" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
