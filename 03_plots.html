<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Dai Shizuka" />


<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Network Analysis Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="tutorials.html">Tutorials</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"><ol start="3" style="list-style-type: decimal">
<li>Plotting Basics</li>
</ol></h1>
<h4 class="author"><em>Dai Shizuka</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#network-plots-layouts-and-attributes">3.1 Network Plots: Layouts and Attributes</a><ul>
<li><a href="#layout">3.1.1 Layout</a></li>
<li><a href="#vertex-attributes">3.1.2 Vertex Attributes</a></li>
</ul></li>
</ul>
</div>

<div id="network-plots-layouts-and-attributes" class="section level2">
<h2>3.1 Network Plots: Layouts and Attributes</h2>
<p>Researchers often use network analysis as a tool for displaying complex data. But you should also know that one must be very careful not to over-interpret network plots. This is because there is no single rule for how to display networks, and network plots can obscure interesting patterns or be misleading if the layout format does not match the purpose. With that said, network plots can be a useful and powerful way to get your message across if used appropriately.</p>
<p>The plotting function in igraph comes with a lot of different options. We have used several arguments already, but if you want to explore the ins and outs of plotting in R, look up <code>?igraph.plotting</code>. I also highly recommend my favorite web tutorial on static and dynamic network visualization by <a href="http://kateto.net/network-visualization">Katya Ognyanova</a>. This site is going to cover the very basics, but I highly recommend her site when you feel ready to do more.</p>
<p>Here, we will deal with two main topics: (1) layout functions and how to merge network data and (2) attribute data to illustrate the network.</p>
<div id="layout" class="section level3">
<h3>3.1.1 Layout</h3>
<p>Let’s start where we left of <a href="02_dataformats.html">Lesson 2</a> and make a network out of a fictional adjacency matrix:</p>
<pre class="r"><code>library(igraph)
am=as.matrix(read.csv(&quot;https://dshizuka.github.io/networkanalysis/SampleData/sample_adjmatrix.csv&quot;, header=T, row.names=1))
am</code></pre>
<pre><code>##         Adam Betty Charles Daniel Esther Frank Gina
## Adam       0     1       0      1      0     4    0
## Betty      1     0       3      1      0     2    0
## Charles    0     3       0      0      0     0    0
## Daniel     1     1       0      0      1     1    0
## Esther     0     0       0      1      0     1    0
## Frank      4     2       0      1      1     0    2
## Gina       0     0       0      0      0     2    0</code></pre>
<pre class="r"><code>g=graph_from_adjacency_matrix(am, mode=&quot;undirected&quot;, weighted=T)
plot(g, edge.width=E(g)$weight)</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-1-1.png" width="576" /></p>
<p>There are several graph layout functions in igraph. You can use these layout functions inside the <code>plot()</code> function, or you can specify the layout as a separate two-column matrix. For example, let’s say you want to arrange the network as a circle:</p>
<pre class="r"><code>#option 1
plot(g, layout=layout_in_circle(g))

#option 2:
l=layout_in_circle(g) 
plot(g, layout=l)</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-2-1.png" width="576" /></p>
<pre class="r"><code>class(l) </code></pre>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<pre class="r"><code>l</code></pre>
<pre><code>##            [,1]       [,2]
## [1,]  1.0000000  0.0000000
## [2,]  0.6234898  0.7818315
## [3,] -0.2225209  0.9749279
## [4,] -0.9009689  0.4338837
## [5,] -0.9009689 -0.4338837
## [6,] -0.2225209 -0.9749279
## [7,]  0.6234898 -0.7818315</code></pre>
<p>You can see that the object <code>l</code> is a two-column matrix of x- and y-coordinates. So this is what the layout functions create, and the plotting functions uses these coordinates to place the nodes. Now let’s learn a little bit about the different types of layout functions.</p>
<div id="force-directed-layouts" class="section level4">
<h4>Force-directed layouts</h4>
<p>Networks are generally plotted using a <em>force-directed algorithm</em>, which is a class of algorithms for drawing graphs. The default function in igraph is called the Fruchterman-Reingold (1991) algorithm. Typically, force-directed algorithms use a physical simulation where some kind of attractive force (imagine a spring) are used to attract nodes connected by edges together. So ‘tightly’ connected clusters of nodes will show up close to each other, and those that are ‘loosely’ connected will be repulsed towards the outside. However, the algorithm does not specify where any node has to be other than these constraints. Therefore, every time you run the <code>plot()</code> command, you will get a slightly different configuration of the graph. Let’s try plotting the network with the default Fruchterman-Reingold algorithm. Run this line of code several times:</p>
<pre class="r"><code>plot(g, layout=layout_with_fr(g))</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-4-1.png" width="576" /></p>
<p>You will observe that each time you plot the graph, you get a different configuration. They all follow the same algorithm, but they turn out differently because the algorithm is simulating a stochastic process of forces acting on nodes. In order to create reproducible layouts, you can use the <code>set.seed()</code> function when setting up the layout.</p>
<pre class="r"><code>set.seed(10) 
l=layout_with_fr(g) 
plot(g, layout=l)</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-5-1.png" width="576" /></p>
<p>Now, your plot should be reproducible when you run the plotting function again. Other popular force-directed algorithms include Kamada &amp; Kawai (1989) and Davidson &amp; Harel (1996), and “GEM” (Frick et al. 1995). They all have slightly different properties and there is no single ‘best method’. Below, we will plot the same network in 8 different ways. The top row will be force-directed methods, and the bottom row will be static methods:</p>
<pre class="r"><code>set.seed(10)
layouts = c(&quot;layout_with_fr&quot;, &quot;layout_with_kk&quot;, &quot;layout_with_dh&quot;, &quot;layout_with_gem&quot;, &quot;layout_as_star&quot;, &quot;layout_as_tree&quot;, &quot;layout_in_circle&quot;, &quot;layout_on_grid&quot;)
par(mfrow=c(2,4), mar=c(1,1,1,1))
for(layout in layouts){
  l=do.call(layout, list(g))
  plot(g, layout=l, edge.color=&quot;black&quot;, vertex.label=&quot;&quot;, main=layout)
}</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-6-1.png" width="576" /></p>
<p>Before we move on, let’s clear the plotting region:</p>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>## null device 
##           1</code></pre>
<p>You can also use custom layouts. I’ll set up the vertices on a line and then used curved edges.</p>
<pre class="r"><code>l=matrix(c(1,2,3,4,5,6,7, 1,2,3,4,5,6,7),ncol=2)
plot(g,layout=l,edge.curved=TRUE, vertex.label=&quot;&quot;)</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-8-1.png" width="576" /></p>
<p>The ability to control the layout is particularly useful when we want to plot spatial networks, as we will see later.</p>
</div>
</div>
<div id="vertex-attributes" class="section level3">
<h3>3.1.2 Vertex Attributes</h3>
<p>Now that we know a bit about how to change the looks of vertices and edges, we are ready to start adding information to our edges. For example, you might have other information about your vertices that you’d like to display in the graph plot: e.g., traits of individuals in a social network, or the attributes of a species in a network of species interactions. Typically, you would store these “node attributes” in a separate file. We will use a sample “attributes file” called sample_attrib.csv. Let’s go ahead and import this file:</p>
<pre class="r"><code>attrib=read.csv(&quot;https://dshizuka.github.io/networkanalysis/SampleData/sample_attrib.csv&quot;)
attrib</code></pre>
<pre><code>##      Name Sex Age
## 1    Adam   M  30
## 2    Gina   F   8
## 3 Charles   M  35
## 4  Daniel   M  15
## 5   Frank   M  10
## 6   Betty   F  28
## 7  Esther   F  12</code></pre>
<p>Now, the goal is to incorporate these vertex attributes, Sex and Age, to the graph object. Note that I have made this data NOT alphabetized on purpose. Therefore, the vertex number and the row numbers of this attributes file do not line up correctly. So we have to first sort these attributes so that we assign the correct attribute to the correct vertex. We can do this by using the <code>match()</code> function.</p>
<pre class="r"><code>V(g)$sex=factor(attrib[match(V(g)$name, attrib$Name), &quot;Sex&quot;]) # factor() preserves data as M/F
V(g)$age=attrib[match(V(g)$name, attrib$Name), &quot;Age&quot;]
g</code></pre>
<pre><code>## IGRAPH 49368a9 UNW- 7 10 -- 
## + attr: name (v/c), sex (v/n), age (v/n), weight (e/n)
## + edges from 49368a9 (vertex names):
##  [1] Adam  --Betty   Adam  --Daniel  Adam  --Frank   Betty --Charles
##  [5] Betty --Daniel  Betty --Frank   Daniel--Esther  Daniel--Frank  
##  [9] Esther--Frank   Frank --Gina</code></pre>
<p>The trick now is to assign colors to each sex. Here, let’s assign males and females to different colors. Here’s one way to do it:</p>
<pre class="r"><code>V(g)$color=c(&quot;gold&quot;,&quot;slateblue&quot;)[as.numeric(V(g)$sex)]</code></pre>
<p>This line of code converts the sex to numbers by alphabetical order, i.e., 1 = female and 2 = male. Now let’s plot the network with node colors as sex and node size as age and add a legend for the node colors:</p>
<pre class="r"><code>set.seed(10)
l=layout_with_fr(g)
plot(g, layout=l,vertex.label=&quot;&quot;, vertex.size=V(g)$age, edge.width=E(g)$weight, edge.color=&quot;black&quot;)
legend(&quot;topleft&quot;, legend=c(&quot;Female&quot;, &quot;Male&quot;), pch=21, pt.bg=c(&quot;gold&quot;, &quot;slateblue&quot;))</code></pre>
<p><img src="03_plots_files/figure-html/unnamed-chunk-12-1.png" width="576" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
